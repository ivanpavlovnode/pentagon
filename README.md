# Pentagon - –ø–∞—Ä–æ–¥–∏–π–Ω—ã–π –ø–æ—Ä—Ç–∞–ª (React/Express)
[üåê–°—Å—ã–ª–∫–∞ –Ω–∞ —Ä–∞–±–æ—á–∏–π –ø—Ä–æ–µ–∫—Ç](https://ivanpavlov.site)
### –î–∞–Ω–Ω—ã–µ –≥–æ—Å—Ç–µ–≤–æ–π —É—á–µ—Ç–Ω–æ–π –∑–∞–ø–∏—Å–∏ (–≤–≤–æ–¥–∏—Ç—å —Ç–æ–ª—å–∫–æ —á–∏—Å–ª–∞!): 
```userData
id: 12 
password: 0000
```

## –û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏
- –ú–µ—Å—Å–µ–Ω–¥–∂–µ—Ä –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ–∏—Å–∫–æ–º —Å–æ–±–µ—Å–µ–¥–Ω–∏–∫–æ–≤ –ø–æ –∏–º–µ–Ω–∏, –∏—Å—Ç–æ—Ä–∏–µ–π —Å–æ–æ–±—â–µ–Ω–∏–π
- –î–æ–∫—É–º–µ–Ω—Ç–æ–æ–±–º–µ–Ω–Ω–∏–∫ —Å –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ–º —Ñ–∞–π–ª–∞, —Å–æ–∑–¥–∞–Ω–∏–µ–º –∏ —Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤.
- –î–æ–∫—É–º–µ–Ω—Ç—ã –º–æ–≥—É—Ç –∏–º–µ—Ç—å —É—Ä–æ–≤–µ–Ω—å –¥–æ—Å—Ç—É–ø–∞, –º–æ–≥—É—Ç –±—ã—Ç—å –∞–¥—Ä–µ—Å–æ–≤–∞–Ω—ã –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É –ø–æ–ª—É—á–∞—Ç–µ–ª—é, –º–æ–≥—É—Ç –±—ã—Ç—å –æ–¥–Ω–æ—Ä–∞–∑–æ–≤—ã–º–∏. 

## –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç—ç–∫
- **Frontend:** React 19.1, styled-components(used in Documents.js)
- **Backend:** Express 5.1.0, supabase-js
- **–î–µ–ø–ª–æ–π:** VPS Ubuntu 24, Nginx

## –û—Å–≤–æ–µ–Ω–Ω—ã–µ –Ω–∞–≤—ã–∫–∏
1. –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è —á–µ—Ä–µ–∑ JWT –≤ sessionStorage
1. –†–µ–∞–ª–∏–∑–æ–≤–∞–ª WebSocket-–ø—Ä–æ—Ç–æ–∫–æ–ª –¥–ª—è –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏
2. –û—Å–≤–æ–∏–ª React-—Ö—É–∫–∏: useState, useRef, useMemo, useEffect
3. –ü—Ä–∏–º–µ–Ω–∏–ª Context API –¥–ª—è –ø–µ—Ä–µ–¥–∞—á–∏ —Å–æ—Å—Ç–æ—è–Ω–∏–π –∏ —Ñ—É–Ω–∫—Ü–∏–π –≤ –¥–æ—á–µ—Ä–Ω–∏–π –∫–æ–º–ø–æ–Ω–µ–Ω—Ç
4. –ü—Ä–∏–º–µ–Ω–∏–ª styled-components –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è —Å—Ç–∏–ª–µ–π –≤ –æ–¥–Ω–æ–º —Ñ–∞–π–ª–µ
5. –û—Å–≤–æ–∏–ª —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥ —á–µ—Ä–µ–∑ —É—Å–ª–æ–≤–∏—è if –∏ &&, —Ç–∞–∫–∂–µ —á–µ—Ä–µ–∑ –º–µ—Ç–æ–¥ .map
6. –ù–∞—É—á–∏–ª—Å—è —Ä–∞–±–æ—Ç–∞—Ç—å c –±–∏–±–ª–∏–æ—Ç–µ–∫–æ–π supabase-js

## –ö—Ä–∞—Ç–∫–æ –æ–± –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ
1. –í —Ä–∞–∑–≤–µ—Ä–Ω—É—Ç–æ–º –Ω–∞ VPS —Å–µ—Ä–∏—Å–µ Express –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –Ω–∞ –ø–æ—Ä—Ç—É 5000, Nginx –ø—Ä–æ–∫—Å–∏—Ä—É–µ—Ç –≤ –Ω–µ–≥–æ –∑–∞–ø—Ä–æ—Å—ã —Å 443 –ø–æ—Ä—Ç–∞.
2. Express –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Å—Ç–∞—Ä–∞–ª—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å –≤ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏–∏ —Å –ø—Ä–∏–Ω—Ü–∏–ø–∞–º–∏ REST, —Å–æ—Å—Ç–æ—è–Ω–∏—è –ø–æ—Å–ª–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –∑–∞–ø—Ä–æ—Å–æ–≤ –Ω–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è, –æ–±–º–µ–Ω –¥–∞–Ω–Ω—ã–º–∏ —Å React –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON, –¥–∞–Ω–Ω—ã–µ —Ö—Ä–∞–Ω—è—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ –ë–î.
3. –í –ø—Ä–æ–µ–∫—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ PostgreSQL –ë–î Supabase, –≤—ã–±–æ—Ä –æ–±—É—Å–ª–æ–≤–ª–µ–Ω –µ–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å—é. –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –ë–î —Ç–æ–ª—å–∫–æ —Å —Å–µ—Ä–≤–µ—Ä–∞ –∏ —Ç–æ–ª—å–∫–æ —á–µ—Ä–µ–∑ –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á. –†–∞–±–æ—Ç–∞–µ—Ç —á–µ—Ä–µ–∑ –±–∏–±–ª–æ—Ç–µ–∫—É supabase-js, SQL –Ω–µ–∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω.
4. –í—Å–µ —Ä–æ—É—Ç—ã, –∫—Ä–æ–º–µ /auth –∑–∞—â–∏—â–µ–Ω—ã –ø—Ä–æ–≤–µ—Ä–∫–æ–π JWT, /auth –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –ø–∞—Ä–æ–ª—å –∏ –¥–∞–µ—Ç —Ç–æ–∫–µ–Ω. –í–µ–±—Å–æ–∫–µ—Ç —Ç–∞–∫–∂–µ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç —Ç–æ–∫–µ–Ω, –ø–µ—Ä–µ–¥–Ω–Ω—ã–π –≤ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞—Ö URL.
5. React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã, –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ —É—Å–ª–æ–≤–∏–µ if, else if —Å –ø–æ–º–æ—â—å—é –ø—Ä–æ–ø—Å–æ–≤ –≤ App.js.
6. –î–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –∏ –ø–æ–∏—Å–∫–∞ –ø–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º –∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞–º –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è useMemo –≤ –∫–∞—Å–∫–∞–¥–µ.
7. –ö–æ–º–ø–æ–Ω–µ–Ω—Ç Documents –∏—Å–ø–æ–ª—å–∑—É–µ—Ç Context API –¥–ª—è —Å–≤—è–∑–∞–Ω–Ω–æ–π —Ä–∞–±–æ—Ç—ã Multiwindow –∏ Documents –±–µ–∑ –ª–∏—à–Ω–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ API.
8. –ü–µ—Ä–µ–¥–∞—á–∞ –∫–ª–∏–µ–Ω—Ç—É React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ —Ä–æ—É—Ç app.get(/.*/, (req, res) => {
9. –†–∞—Å—à–∏—Ä–µ–Ω–∏–µ React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–æ–∑–º–æ–∂–Ω–æ —á–µ—Ä–µ–∑ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–µ API - —á–µ—Ä–µ–∑ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ä–æ—É—Ç–æ–≤ –∏ –≤–Ω–µ–¥—Ä–µ–Ω–∏–µ Express Router.
10. –í–µ–±—Å–æ–∫–µ—Ç —Å–µ—Ä–≤–µ—Ä —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω –ø–æ–≤–µ—Ä—Ö http —Å–µ—Ä–≤–µ—Ä–∞, –∞–ø–≥—Ä–µ–π–¥ –≤—Ä—É—á–Ω—É—é.
11. –ü–µ—Ä–µ—á–µ–Ω—å API —ç–Ω–¥–ø–æ–∏–Ω—Ç–æ–≤:
```js
post('/api/auth'            //–ø—Ä–æ–≤–µ—Ä–∫–∞ –ø–∞—Ä–æ–ª—è –∏ –≤–æ–∑–≤—Ä–∞—â–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞
get('/api/avatars'          //–ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è, –º–æ–∂–µ—Ç –±—ã—Ç—å –∑–∞–º–µ–Ω–µ–Ω–æ –Ω–∞ /byid
get('/api/avatars/byid'     //–ø–æ–ª—É—á–µ–Ω–∏–µ –∞–≤–∞—Ç–∞—Ä–∞ –ø–æ –ø–µ—Ä–µ–¥–∞–Ω–Ω–æ–º—É –∞–π–¥–∏
post('/api/avatars'         //–∑–∞–º–µ–Ω–∞ –∞–≤–∞—Ç–∞—Ä–∞, –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å –∏–∑–º–µ–Ω–µ–Ω–æ –Ω–∞ patch
get('/api/staff'            //–ø–æ–ª—É—á–µ–Ω–∏–µ –≤—Å–µ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è—Ö
get('/api/messenger'        //–ø–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
post('/api/messenger'       //–æ—Ç–º–µ—Ç–∫–∞ –ø–æ–ª—É—á–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º —Å–æ–æ–±—â–µ–Ω–∏–π
get('/api/documents'        //–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
patch('/api/documents'      //—Ä–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Å–≤–æ–µ–≥–æ –¥–æ–∫—É–º–µ–Ω—Ç–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
post('/api/documents'       //–ø–æ–ª—É—á–µ–Ω–∏–µ –¥–æ–∫—É–º–µ–Ω—Ç–æ–≤, –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
get('/api/documents/file'   //–ø–æ–ª—É—á–µ–Ω–∏–µ –ø—Ä–∏–∫–ø–µ–ª–µ–Ω–Ω–æ–≥–æ –∫ –¥–æ–∫—É–º–µ–Ω—Ç—É —Ñ–∞–π–ª–∞
post('/api/documents/file'  //–¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø—Ä–∏–∫—Ä–µ–ø–ª–µ–Ω–Ω–æ–≥–æ —Ñ–∞–π–ª–∞
```
    
## –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫
### –í–∞–º –ø–æ—Ç—Ä–µ–±—É–µ—Ç—Å—è –±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö supabase (–≤ –º–æ–µ–º –≤–∞—Ä–∏–∞–Ω—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∞ –±–µ—Å–ø–ª–∞—Ç–Ω–∞—è nano), –≤ –Ω–µ–π –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—ã.
SQL-–∫–æ–º–∞–Ω–¥—ã –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è —Ç–∞–±–ª–∏—Ü —Å –Ω—É–∂–Ω–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –≤ scheme"public"
```sql
CREATE TABLE public.Documents (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  creator integer NOT NULL,
  recipient integer,
  access_level smallint,
  docdata json NOT NULL,
  delivered boolean DEFAULT false,
  disposable boolean DEFAULT false,
  date timestamp without time zone,
  version integer NOT NULL DEFAULT 0,
  file_extension text,
  CONSTRAINT Documents_pkey PRIMARY KEY (id)
);
CREATE TABLE public.Messenger (
  id bigint GENERATED ALWAYS AS IDENTITY NOT NULL,
  sender integer NOT NULL,
  getter integer,
  text text,
  delivered boolean NOT NULL DEFAULT false,
  CONSTRAINT Messenger_pkey PRIMARY KEY (id)
);
CREATE TABLE public.Staff (
  id integer GENERATED ALWAYS AS IDENTITY NOT NULL,
  full_name text NOT NULL DEFAULT 'FULL NAME'::text,
  call_name text,
  rank text NOT NULL DEFAULT 'PVT'::text,
  div text NOT NULL DEFAULT '315P'::text,
  status text NOT NULL DEFAULT 'ACTIVE'::text,
  access_level smallint NOT NULL DEFAULT '1'::smallint,
  password text NOT NULL DEFAULT '1111'::text,
  service_record text NOT NULL DEFAULT 'No record'::text,
  CONSTRAINT Staff_pkey PRIMARY KEY (id)
);
```
–¢–∞–∫–∂–µ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥–≤–µ –∫–æ—Ä–∑–∏–Ω—ã –≤ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ —Å –∏–º–µ–Ω–∞–º–∏ "avatars" –∏ "documents". –í —Ç–∞–±–ª–∏—Ü–µ Staff —Å–æ–∑–¥–∞–π—Ç–µ —Å–≤–æ—é —É—á–µ—Ç–Ω—É—é –∑–∞–ø–∏—Å—å —Å –ø–∞—Ä–æ–ª–µ–º. 
# –ó–∞—Ç–µ–º –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å .env —Ñ–∞–π–ª –≤ /backend, –∏ –∑–∞–ø–æ–ª–Ω–∏—Ç—å –∫–∞–∫ –ø–æ–∫–∞–∑–∞–Ω–æ –Ω–∏–∂–µ.
### –ù–µ –∑–∞–±—É–¥—å—Ç–µ –≤–ø–∏—Å–∞—Ç—å —Å–≤–æ–∏ –∑–Ω–∞—á–µ–Ω–∏—è –¥–ª—è URL, API –∫–ª—é—á–µ–π –∏ JWT —Å–µ–∫—Ä–µ—Ç–∞.
```env
SUPABASE_URL=your.supabase.url
SUPABASE_ANON_KEY=yourAnonKeyFromSupabase
SUPABASE_SERVICE_ROLE_KEY=yourServiceKeyFromSupabase
JWT_SECRET=yourKeyEnterWhatYouWantItMustBeStrong
PORT=5000
NODE_ENV=production
```

–ö–æ–≥–¥–∞ –≤—Å–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–æ, –≤ —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –Ω—É–∂–Ω–æ –ø–µ—Ä–µ–π—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏—é –¥–ª—è –ø—Ä–æ–µ–∫—Ç–∞ –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å:
```bash
git clone https://github.com/bickdick0/pentagon
cd pentagon/backend
npm install
cd client
npm install
cd ../
npm run build-client
npm start
```
–ß—Ç–æ–±—ã –ø–æ–ª—É—á–∏—Ç—å SPA –æ—Ç –ª–æ–∫–∞–ª—å–Ω–æ–≥–æ —Å–µ—Ä–≤–µ—Ä–∞ –≤ –∞–¥—Ä–µ—Å–Ω–æ–π —Å—Ç—Ä–æ–∫–µ –±—Ä–∞—É–∑–µ—Ä–∞ –≤–≤–µ–¥–∏—Ç–µ localhost:5000
